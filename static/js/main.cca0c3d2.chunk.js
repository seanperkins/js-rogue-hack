(this.webpackJsonpnew=this.webpackJsonpnew||[]).push([[0],{35:function(t,e,i){},36:function(t,e,i){"use strict";i.r(e);var n=i(6),r=i.n(n),a=i(20),c=i.n(a),o=i(7),h=i(5),l=Object(n.createContext)({}),u=l;function d(t){var e=t.children,i=Object(n.useState)({state:"menu"}),r=Object(o.a)(i,2),a=r[0],c=r[1];return Object(h.jsx)(l.Provider,{value:{game:a,setGame:c},children:e})}var g,s=i(13),f={horizontalLine:"\xc4",verticalLine:"\xb3",upperRightCorner:"\xbf",upperLeftCorner:"\xda",lowerRightCorner:"\xd9",lowerLeftCorner:"\xc0",lightShade:"\xb0",darkShade:"\xb1",darkestShade:"\xb2"},b="#000000",j="#00FF00";!function(t){t[t.TERMINALS=0]="TERMINALS",t[t.CORPSE=1]="CORPSE",t[t.ITEM=2]="ITEM",t[t.ACTOR=3]="ACTOR"}(g||(g={}));var v=i(24),x=i(21),O=i.n(x),m=i(23),w=i(22),p=i(17),y=i(0),C=function t(e){var i=this;Object(y.a)(this,t),this.tileSet=void 0,this.tileMap=void 0,this.tileWidth=void 0,this.tileHeight=void 0,this.tileSet=document.getElementById(e),this.tileMap={},this.tileWidth=12,this.tileHeight=12,Object.keys(S).forEach((function(t){var e=S[t];i.tileMap[t]=[e[0]*i.tileWidth,e[1]*i.tileHeight]}));for(var n=0;n<256;n++)this.tileMap[String.fromCharCode(n)]=[n%16*this.tileWidth,Math.floor(n/16)*this.tileHeight]},S={blank:[0,0],lightTexture:[0,11],mediumTexture:[0,12],darkTexture:[0,13],verticalLine:[11,11],horizontalLine:[5,13]},E=Object(n.createContext)(null),M=E,L=function(t){var e=t.children,i=Object(n.useState)(null),r=Object(o.a)(i,2),a=r[0],c=r[1],l=Object(n.useState)({width:0,height:0}),u=Object(o.a)(l,2),d=u[0],g=u[1],s=Object(n.useState)(!1),f=Object(o.a)(s,2),v=f[0],x=f[1],O=Object(n.useState)([null,null]),m=Object(o.a)(O,2),y=m[0],S=m[1];function M(t){for(var e=t.height,i=t.width,n=t.x,r=t.y,c=t.fg,o=t.bg,h=t.char||" ",l=c||j,u=o||b,d=0;d<i;d++)for(var g=0;g<e;g++)a.draw(d+n,g+r,h,l,u)}return Object(n.useEffect)((function(){if(window.game.display)c(window.game.display);else{var t=new C("tileset"),e=T(t),i=e.width,n=e.height;g({width:i,height:n});var r=new p.a({width:i,height:n,fontSize:12,spacing:0,layout:"tile-gl",tileColorize:!0,tileWidth:t.tileWidth,tileHeight:t.tileHeight,tileSet:t.tileSet,tileMap:t.tileMap,bg:b,fg:j}),a=r.getContainer();document.getElementById("game").appendChild(a),c(r),window.game.display=r}}),[]),Object(n.useEffect)((function(){if(a){var t=d.width,e=d.height,i=a.getOptions(),n=i.width,r=i.height;if(t!==n||e!==r){var o=new C("tileset"),h=new p.a({width:t,height:e,fontSize:12,spacing:0,layout:"tile-gl",tileColorize:!0,tileWidth:o.tileWidth,tileHeight:o.tileHeight,tileSet:o.tileSet,tileMap:o.tileMap,bg:b,fg:j}),l=h.getContainer();document.getElementById("game").replaceChildren(l),c(h),window.game.display=h}}}),[a,d]),Object(n.useEffect)((function(){if(a){var t=function(t){x(!0),setTimeout((function(){return x(!1)}),1)},e=function(t){var e=a.eventToPosition(t);S(e)},i=Object(w.debounce)((function(){var t=T(new C("tileset")),e=t.width,i=t.height;g({width:e,height:i})}),100),n=a.getContainer();return function(n){n.addEventListener("click",t),n.addEventListener("mousemove",e),window.addEventListener("resize",i)}(n),function(){return function(n){n.removeEventListener("click",t),n.removeEventListener("mousemove",e),window.removeEventListener("resize",i)}(n)}}}),[a]),Object(h.jsx)(E.Provider,{value:{display:a,getCenter:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.height,i=t.width,n=a.getOptions(),r=n.width,c=n.height,o=e||0,h=i||0;return[Math.floor(r/2-h/2),Math.floor(c/2-o/2)]},getHalfSize:function(){var t=a.getOptions(),e=t.width,i=t.height;return{width:Math.floor(e/2),height:Math.floor(i/2)}},clearDisplay:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.getOptions().height,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.getOptions().width,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;M({height:t,width:e,x:i,y:n,fg:b,bg:b,char:" "})},fillDisplay:M,drawText:function(t){var e=t.x,i=t.y,n=t.text,r=t.maxWidth,c=t.fg,o=t.bg,h=c||j,l=o||b;return a.drawText(e,i,"%c{".concat(h,"}%b{").concat(l,"}").concat(n),r),r?Math.ceil(n.length/r):1},drawGrid:function(t){for(var e=t.grid,i=t.fg,n=t.bg,r=a.getOptions(),c=r.height,o=r.width,h=0;h<o;h++)for(var l=0;l<c;l++){var u=e["".concat(h,",").concat(l)];if(u){var d=u.fg||i,g=u.bg||n;a.draw(h,l,u.char,d,g)}}},drawMatrix:function(t){var e=t.matrix,i=t.x,n=t.y;e.forEach((function(t,e){t.forEach((function(t,r){Object.keys(t).length&&a.draw(r+i,e+n,t.char,t.fg,t.bg)}))}))},clicked:v,mouseXY:y,displaySize:d},children:e})};function T(t){var e=window.innerWidth,i=window.innerHeight;return{width:Math.floor(e/t.tileWidth),height:Math.floor(i/t.tileHeight)}}var W=function(t){var e="withRouter(".concat(t.displayName||t.name,")"),i=function(i){var n=i.wrappedComponentRef,r=Object(v.a)(i,["wrappedComponentRef"]);return Object(h.jsx)(M.Consumer,{children:function(i){return Object(m.a)(i,"You should not use <".concat(e," /> outside a <Router>")),Object(h.jsx)(t,Object(s.a)(Object(s.a)(Object(s.a)({},r),i),{},{ref:n}))}})};return i.displayName=e,i.WrappedComponent=t,O()(i,t)};var k=W((function(t){var e=t.x,i=t.y,n=t.text,r=t.drawText,a=t.fg,c=t.bg,o=t.maxWidth;return r({x:e,y:i,text:n.toUpperCase(),fg:a,bg:c,maxWidth:o}),null}));var R=W((function(t){var e=t.x,i=t.y,n=t.text,r=t.fg,a=t.bg,c=t.onClick,l=t.inner,u=t.mouseXY,d=t.clicked,g=r||b,s=a||j,f=n.length,v=l.x,x=l.y,O=l.width,m=e+v,w=i+x,p=function(t,e,i){var n=Object(o.a)(t,2),r=n[0],a=n[1],c=Object(o.a)(e,2),h=c[0],l=c[1],u=Object(o.a)(i,2),d=u[0],g=u[1];return h>=r&&h<=r+d&&l>=a&&l<=a+g}([m,w],u,[f,1]);return p&&d&&c(),Object(h.jsx)(k,{x:m,y:w,text:n,fg:p?g:s,bg:p?s:g,maxWidth:O})}));var z=W((function(t){var e=t.x,i=t.y,n=t.height,r=t.width,a=t.fg,c=t.bg,o=t.char;return(0,t.fillDisplay)({x:e,y:i,width:r,height:n,fg:a,bg:c,char:o}),null}));var H=W((function(t){for(var e=t.title,i=t.x,a=t.y,c=t.width,o=t.height,l=t.children,u=t.display,d=0;d<c;d++)for(var g=0;g<o;g++){var s=" ";0===d&&0===g?s=f.upperLeftCorner:d===c-1&&0===g?s=f.upperRightCorner:0===d&&g===o-1?s=f.lowerLeftCorner:d===c-1&&g===o-1?s=f.lowerRightCorner:0===d||d===c-1?s=f.verticalLine:0!==g&&g!==o-1||(s=f.horizontalLine)," "!==s&&u.draw(d+i,g+a,s,j,b)}return Object(h.jsxs)(n.Fragment,{children:[e&&Object(h.jsx)(k,{x:i+1,y:a,text:e}),l&&r.a.Children.map(l,(function(t){return r.a.cloneElement(t,{inner:t.props.inner?t.props.inner:{x:i+1,y:a+1,width:c-2,height:o-2}})}))]})}));var I=W((function(t){var e=t.title,i=t.x,a=t.y,c=t.width,o=t.height,l=t.fg,u=t.bg,d=t.shadow,g=t.children,s=l||j,f=u||b;return Object(h.jsxs)(H,{x:i,y:a,width:c,height:o,fg:s,bg:f,children:[Object(h.jsx)(z,{x:i+1,y:a+1,height:o-2,width:c-2,bg:f,fg:s}),Object(h.jsx)(z,{x:i+1,y:a+1,height:1,width:c-2,bg:s}),Object(h.jsx)(k,{x:i+1,y:a+1,text:e,fg:f,bg:s}),d&&Object(h.jsxs)(n.Fragment,{children:[Object(h.jsx)(z,{x:i+1,y:a+o,height:1,width:c,fg:s,bg:f,char:"\xb0"}),Object(h.jsx)(z,{x:i+c,y:a+1,height:o-1,width:1,fg:s,bg:f,char:"\xb0"})]}),g&&r.a.Children.map(g,(function(t){return r.a.cloneElement(t,{inner:{x:i+1,y:a+2,width:c-3,height:o-3}})}))]})}));var F=W((function(t){var e=t.getCenter,i=t.clearDisplay,r=Object(n.useContext)(u),a=r.game,c=r.setGame;i();var l=[{label:"New Game",onClick:function(){c(Object(s.a)(Object(s.a)({},a),{},{state:"terminal"}))}},{label:"Load Game",onClick:function(){console.log("Load Game")}}],d=e({width:20,height:20}),g=Object(o.a)(d,2),f=g[0],b=g[1];return Object(h.jsx)(I,{x:f,y:b,width:20,height:20,title:"Main Menu",shadow:!0,children:l.map((function(t,e){return Object(h.jsx)(R,{text:t.label,x:1,y:2*e+1,onClick:t.onClick},t.label)}))})}));function P(){var t,e=(t=255,Math.floor(Math.random()*t));return String.fromCharCode(e)}var D=function(t){var e=t.x,i=t.y,r=t.text,a=t.fg,c=t.bg,l=t.maxWidth,u=t.glitchLevel,d=t.glitchFrequency,g=Object(n.useState)(!1),s=Object(o.a)(g,2),f=s[0],b=s[1];Object(n.useEffect)((function(){b(!0)}),[]),Object(n.useEffect)((function(){var t;return t=f?setTimeout((function(){b(!1)}),500):setTimeout((function(){b(!0)}),d?1e3*d:5e3),function(){return clearTimeout(t)}}),[f,d]);var j=f?function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,i="",n=0;n<t.length;n++)" "===t[n]?i+=" ":p.b.getUniform()<e?i+=P():i+=t[n];return i}(r,u):r;return Object(h.jsx)(k,{x:e,y:i,text:j,fg:a,bg:c,maxWidth:l})};var G=function(t){var e=t.x,i=t.y,r=t.fg,a=t.text,c=t.speed,l=t.delay,u=t.maxWidth,d=t.onComplete,g=t.glitched,s=Object(n.useState)(""),f=Object(o.a)(s,2),b=f[0],j=f[1],v=Object(n.useState)(null),x=Object(o.a)(v,2),O=x[0],m=x[1],w=Object(n.useState)(!1),p=Object(o.a)(w,2),y=p[0],C=p[1];return Object(n.useEffect)((function(){return m(setTimeout((function(){j(a.substring(0,b.length+1))}),l||500)),clearTimeout(O)}),[]),Object(n.useEffect)((function(){y||m(setTimeout((function(){a!==b?j(a.substring(0,b.length+1)):(C(!0),d&&d())}),c||150))}),[b,a,c,d,y]),g?Object(h.jsx)(D,{x:e,y:i,text:b,fg:r,maxWidth:u}):Object(h.jsx)(k,{x:e,y:i,fg:r,text:b,maxWidth:u})};var A=W((function(t){var e=t.display,i=t.clearDisplay,r=(t.getCenter,t.getHalfSize,Object(n.useState)(0)),a=Object(o.a)(r,2),c=a[0],l=a[1],u=["Oh good. You seem to have booted up.","Are you receiving my input?","I think there might an issue.","Can you try to reboot?"],d=e.getOptions().width;function g(){c<u.length-1&&l(c+1)}var s=u.map((function(t,e){return e>c?null:Object(h.jsx)(G,{x:1,y:1+2*e,text:u[e],fg:j,maxWidth:d-2,glitched:!0,onComplete:g},e)}));return i(),s}));var B=W((function(t){var e=t.display,i=Object(n.useContext)(u).game;if(!e)return null;switch(i.state){case"menu":return Object(h.jsx)(F,{});case"terminal":return Object(h.jsx)(A,{});default:return null}})),N=Object(n.createContext)({});function Y(t){var e=t.children,i=Object(n.useState)([]),r=Object(o.a)(i,2),a=r[0],c=r[1];return Object(h.jsx)(N.Provider,{value:{messages:a,add:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"into",i=a.slice(),n=i[i.length-1]||{};n.text===t?n.count++:i.push({text:t,type:e,count:1}),c(i)}},children:e})}var J=function(){return Object(h.jsx)(Y,{children:Object(h.jsx)(L,{children:Object(h.jsx)(d,{children:Object(h.jsx)(B,{})})})})},U=function(t){t&&t instanceof Function&&i.e(3).then(i.bind(null,37)).then((function(e){var i=e.getCLS,n=e.getFID,r=e.getFCP,a=e.getLCP,c=e.getTTFB;i(t),n(t),r(t),a(t),c(t)}))};i(35);c.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(J,{})}),document.getElementById("root")),U()}},[[36,1,2]]]);
//# sourceMappingURL=main.cca0c3d2.chunk.js.map